{% extends 'website/layout.html' %}
{% block title %}
 Linkr | Edit
{% endblock %}

{% block body %}
<br>
<h1 class="text-center">Editing {{ user }}'s page:</h1>

<br>

<div class="row align-items-start">
  <div class="col has-shadow" style="border:1px solid #eeeeee; padding:20px; border-radius:7px;">
    <form action="/edit" method="post" enctype="multipart/form-data">
      {% csrf_token %}
      <h3>Bio:</h3>
      <hr>
      <textarea rows="5" cols="5" class="form-control" id="bio" name="bio">

      </textarea>
      <br>
      <h3>Change Profile Picture:</h3>
      <h6>Leave empty to do nothing</h6>
      <hr>
      <input class="form-control" type="file" name="image" id="image">
      <br>
      <h3>Page Content:</h3>
      <hr>
      <textarea rows="10" cols="10" class="form-control" id="content" name="content">

      </textarea>
      <br>
      <h3>Color Scheme</h3>
      <h6>Choose one here or create your own below.</h6>
      <hr>
      <select name="colorscheme" id="colorscheme" class="form-control">
        {% for colorscheme in colorschemes %}
          <option id="{{ colorscheme.name }}" value="{{ colorscheme.name }}">{{ colorscheme.name }}</option>
        {% endfor %}
      </select>
      <br>
      <h3>Page Style:</h3>
      <hr>
      <textarea rows="10" cols="10" class="form-control" id="css" name="css">

      </textarea>
      <br>

      <div class="form-group">
        Enable watermark?
        <input type="checkbox" id="checkbox" name="checkbox" {% if watermark %} checked {% endif %}>
      </div>

      <input type="submit" value="Edit" class="btn btn-block btn-outline-primary">
    </form>
  </div>
  <div class="col-3">
    <button class="btn btn-outline-primary" onclick="add_cat()">Add Category</button>
    <button class="btn btn-outline-primary" onclick="add_link()">Add Link</button>
  </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
  document.querySelector('#content').value = '';
  document.querySelector('#css').value = '';
  document.querySelector('#bio').value = '';
  {% for category in categories %}
    document.querySelector('#content').value += '# {{ category.name }}\n';
    {% for link in links %}
      {% if link.category == category %}
        document.querySelector('#content').value += '[{{ link.name }}]({{ link.url }})\n';
      {% endif %}
    {% endfor %}
  {% endfor %}
  document.querySelector('#css').value += '{{ style.css }}';
  document.querySelector('#bio').value += '{{ bio }}';
  document.querySelector('#{{ user_colorscheme }}').setAttribute('selected', '')
})

var add_cat = function() {
  document.querySelector('#content').value += '# Category Name\n';
}

var add_link = function() {
  document.querySelector('#content').value += '[Link Name](Link URL)\n';
}
</script>

{% endblock %}
